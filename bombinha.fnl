;; title:   Bombinha TIC
;; author:  crocidb
;; desc:    use your bomb
;; site:    https://crocidb.com/
;; license: All Rights Reserved
;; version: 0.1
;; script:  fennel
;; strict:  true

(var time 0)

;; LIB FUNCTIONS

;; Sprite
(fn sprite-create [idlist speed basecolor]
  {:idlist idlist :speed speed :basecolor basecolor})

(fn sprite-draw [animsprite x y]
  (let [current-sprite (. animsprite.idlist (+ 1 (% (// time animsprite.speed) (length animsprite.idlist))))]
    (spr current-sprite x y 0 animsprite.basecolor 0 0 2 2)))

;; Entity
(fn entity-create [x y spritelist]
  {:x x :y y :sprite spritelist})

(fn entity-draw [entity]
   (sprite-draw entity.sprite entity.x entity.y))

;; GAME STATES

(var game {:update (fn [])})

;; Game

(var stategame {:data {} :reset (fn []) :update (fn [])})
(set stategame.data.bomb (entity-create 0 0 (sprite-create [33 35] 10 1)))
(set stategame.update (fn []
  (cls 0)
  (entity-draw stategame.data.bomb)))

;; INITIALIZATION 

(set game.update stategame.update)

(fn _G.TIC []
  (set time (+ time 1))
  (game.update))

;; TIC-80 METADATA

;; <TILES>
;; 001:eccccccccc888888caaaaaaaca888888cacccccccacc0ccccacc0ccccacc0ccc
;; 002:ccccceee8888cceeaaaa0cee888a0ceeccca0ccc0cca0c0c0cca0c0c0cca0c0c
;; 003:eccccccccc888888caaaaaaaca888888cacccccccacccccccacc0ccccacc0ccc
;; 004:ccccceee8888cceeaaaa0cee888a0ceeccca0cccccca0c0c0cca0c0c0cca0c0c
;; 017:cacccccccaaaaaaacaaacaaacaaaaccccaaaaaaac8888888cc000cccecccccec
;; 018:ccca00ccaaaa0ccecaaa0ceeaaaa0ceeaaaa0cee8888ccee000cceeecccceeee
;; 019:cacccccccaaaaaaacaaacaaacaaaaccccaaaaaaac8888888cc000cccecccccec
;; 020:ccca00ccaaaa0ccecaaa0ceeaaaa0ceeaaaa0cee8888ccee000cceeecccceeee
;; 033:0000000000000000000000000000000f00000fff0000feee00ffeede00feedee
;; 034:000000000023000002000000f0000000fff00000eeef0000eeeeff00eeeeef00
;; 035:00000000000000000000000f00000fff0000feee00ffeede00feedee0feedeee
;; 036:0023000002000000f0000000fff00000eeef0000eeeeff00eeeeef00eeeeeef0
;; 049:0feedeee0feeeeee0feeeeee0feeeeee00feeeee000feeee0000feee00000fff
;; 050:eeeeeef0eeeeeef0eeeeeef0eeeeeef0eeeeef00eeeef000eeef0000fff00000
;; 051:0feeeeee0feeeeee0feeeeee0feeeeee00feeeee000feeee0000feee00000fff
;; 052:eeeeeef0eeeeeef0eeeeeef0eeeeeef0eeeeef00eeeef000eeef0000fff00000
;; </TILES>

;; <WAVES>
;; 000:00000000ffffffff00000000ffffffff
;; 001:0123456789abcdeffedcba9876543210
;; 002:0123456789abcdef0123456789abcdef
;; 003:0111233d4cc5b59788879abcdddeef32
;; 005:00a0877656688889aaabcb8765765432
;; 006:122387765443322bccba997655433211
;; 007:feedddccbbaa99987769554433221100
;; 009:79aabba987654444568abbbbba987543
;; </WAVES>

;; <SFX>
;; 000:56033602260116011600160026002600260036004600660086009600a600b600c600c600d600d600d600d600e600e600e600f600f600f600f600f600302000000000
;; 001:16003600560066006600760076008600860096009600a600a600a600b600b600b600c600c600c600c600d600d600e600e600e600f600f600f600f600305000000000
;; 002:4b001b051b041b032b022b003b0f5b0e8b00bb00cb00db00eb00eb00eb00fb00fb00fb00fb00fb00fb00fb00fb00fb00fb00fb00fb00fb00fb00fb0040b000000000
;; 003:0900290049007900a900c900e900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900f900203000000000
;; </SFX>

;; <PATTERNS>
;; 000:500006600006000000800006000000b00006000000a00006a00006a00006000000000000000000000000000000000000a00006000000800006600006000000000000500006000000a00004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
;; 001:500014100000500014100000500014000000500014000000500014000000500014000000500014000000500014000000500014000000500014000000500014000000500004000000500004000000500004000000500004000000500004000000500004000000500004000000500004000000500004000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
;; 002:400034000000100020000000a00028000000400038000000400038000000000000a00028000030000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
;; </PATTERNS>

;; <TRACKS>
;; 000:100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001040
;; 001:180300100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030
;; 002:100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
;; </TRACKS>

;; <PALETTE>
;; 000:1a1c2c5d275db13e53ef7d57ffcd75a7f07038b76425717929366f3b5dc941a6f673eff7f4f4f494b0c2566c86333c57
;; </PALETTE>

